/* 主题过渡动画样式 - 渐变扫过效果 */

/* 渐变遮罩从左向右扫过 */
@keyframes gradient-sweep {
  from {
    mask-position: 100% 0;
  }
  to {
    mask-position: 0 0;
  }
}

/* 过渡组高度为视口高度，否则高度巨大的时候会特别耗费性能 */
html.theme-transition::view-transition-group(root) {
  height: 100dvh;
  overflow: clip;
}

html.theme-transition::view-transition-image-pair(root) {
  isolation: isolate;
  height: 100dvh;
}

/* 旧主题保持不动 */
html.theme-transition::view-transition-old(root) {
  animation: none;
  z-index: 0;
  height: 100%;
  object-fit: cover;
  object-position: left top;
}

/* 新主题通过渐变遮罩从左到右揭示 */
html.theme-transition::view-transition-new(root) {
  mask-image: linear-gradient(to right, black 40%, transparent 60%);
  mask-size: 300% 100%;
  animation: gradient-sweep 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  z-index: 1;
  height: 100%;
  object-fit: cover;
  object-position: left top;
}

/* During theme transition, merge header into root snapshot */
html.theme-transition #site-header {
  view-transition-name: none;
}

/* 尊重用户的减少动画偏好 */
@media (prefers-reduced-motion: reduce) {
  html.theme-transition::view-transition-new(root),
  html.theme-transition::view-transition-old(root) {
    animation: none;
  }
}

/* 保留原始的视图过渡，但不应用特殊效果，除非有theme-transition类 */
::view-transition-new(root) {
  z-index: 1;
}

::view-transition-old(root) {
  z-index: 0;
}

html.dark .astro-code,
html.dark .astro-code span {
  /* biome-ignore lint/complexity/noImportantStyles: Safe - Shiki code blocks */
  color: var(--shiki-dark) !important;
  /* biome-ignore lint/complexity/noImportantStyles: Safe - Shiki code blocks */
  background-color: var(--shiki-dark-bg) !important;
  /* Optional, if you also want font styles */
  /* font-style: var(--shiki-dark-font-style) !important; */
  /* biome-ignore lint/complexity/noImportantStyles: Safe - Shiki code blocks */
  font-weight: var(--shiki-dark-font-weight) !important;
  /* biome-ignore lint/complexity/noImportantStyles: Safe - Shiki code blocks */
  text-decoration: var(--shiki-dark-text-decoration) !important;
}
