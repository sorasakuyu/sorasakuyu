---
import { buildCategoryPath, type Category, translateCategoryName } from '@lib/content';
import { getLocaleFromUrl, localizedPath } from '@/i18n';
import CategoryTitle from './CategoryTitle.astro';

interface Props {
  category: Category;
  parentName: string;
  countMap: Record<string, number>;
}

const { category, parentName, countMap } = Astro.props;
const locale = getLocaleFromUrl(Astro.url.pathname);
---

<CategoryTitle
  title={translateCategoryName(category.name, locale)}
  count={countMap[category.name]}
  href={localizedPath(buildCategoryPath([parentName, category.name]), locale)}
  level="h3"
/>
{
  category.children?.length && (
    <div class="category-second-level-container flex flex-col">
      {category.children.map((grandChild) => (
        <p class="shoka-decoration-circle relative px-7.5 py-2 text-base/9 text-primary hover:text-blue">
          <a href={localizedPath(buildCategoryPath([parentName, category.name, grandChild.name]), locale)} class="dashed-border">
            {translateCategoryName(grandChild.name, locale)}
          </a>
          <span class="text-sm text-muted-foreground">({countMap[grandChild.name] ?? 0})</span>
        </p>
      ))}
    </div>
  )
}
<!-- </div> -->
