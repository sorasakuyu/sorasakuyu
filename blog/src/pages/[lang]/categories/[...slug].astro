---
import { getCategoryByLink, getCategoryLinks, getCategoryList } from '@lib/content';
import { defaultLocale, localeList } from '@/i18n/config';
import CategoryPage from '../../categories/[...slug].astro';

export async function getStaticPaths() {
  const nonDefaultLocales = localeList.filter((l) => l !== defaultLocale);
  const paths = [];

  for (const lang of nonDefaultLocales) {
    const { categories } = await getCategoryList(lang);
    const links = getCategoryLinks(categories, '');

    for (const link of links) {
      const category = getCategoryByLink(categories, link);
      paths.push({
        params: { lang, slug: link },
        props: { category },
      });
    }
  }

  return paths;
}

const { category } = Astro.props;
---
<CategoryPage category={category} />
