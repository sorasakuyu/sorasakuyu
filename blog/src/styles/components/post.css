/* ============================================
   CSS 计数器:标题编号系统
   支持 H1-H6 所有级别,处理混合使用场景
   ============================================ */

/* 1. 初始化计数器:在 TOC 根容器重置根级别计数器 */
.toc-container {
  counter-reset: heading-h2;
}

/* 2. 每个标题链接在递增自己的计数器时,重置所有子级计数器 */

/* H1: 不编号 (通常是文章标题，不需要编号) */
.heading-link[data-level="1"] {
  counter-reset: heading-h2;
}

.heading-link[data-level="1"]::before {
  content: none;
}

/* H2: "1. " (作为根级别) */
.heading-link[data-level="2"] {
  counter-increment: heading-h2;
  counter-reset: heading-h3;
}

.heading-link[data-level="2"]::before {
  content: counter(heading-h2) ". ";
}

/* H3: "1.1. " */
.heading-link[data-level="3"] {
  counter-increment: heading-h3;
  counter-reset: heading-h4;
}

.heading-link[data-level="3"]::before {
  content: counter(heading-h2) "." counter(heading-h3) ". ";
}

/* H4: "1.1.1. " */
.heading-link[data-level="4"] {
  counter-increment: heading-h4;
  counter-reset: heading-h5;
}

.heading-link[data-level="4"]::before {
  content: counter(heading-h2) "." counter(heading-h3) "." counter(heading-h4) ". ";
}

/* H5: "1.1.1.1. " */
.heading-link[data-level="5"] {
  counter-increment: heading-h5;
  counter-reset: heading-h6;
}

.heading-link[data-level="5"]::before {
  content: counter(heading-h2) "." counter(heading-h3) "." counter(heading-h4) "." counter(heading-h5) ". ";
}

/* H6: "1.1.1.1.1. " */
.heading-link[data-level="6"] {
  counter-increment: heading-h6;
}

.heading-link[data-level="6"]::before {
  content: counter(heading-h2) "." counter(heading-h3) "." counter(heading-h4) "." counter(heading-h5) "." counter(heading-h6)
    ". ";
}

/* 4. 编号样式:等宽数字,右侧间距,柔和颜色 */
.heading-link::before {
  display: inline-block;
  margin-right: 0.25rem; /* 4px 间距 */
  font-variant-numeric: tabular-nums; /* 等宽数字对齐 */
  color: hsl(var(--muted-foreground));
  transition: color 200ms;
}

/* 5. 激活状态:编号也变为主题色 */
.heading-link.text-primary::before {
  color: hsl(var(--primary));
}

/* 6. 禁用编号:通过 .toc-no-numbering 类隐藏所有编号 */
.toc-no-numbering .heading-link::before {
  display: none;
}

/* 目录项的平滑过渡动画 */
.toc-item {
  position: relative;
  overflow: hidden;
}

.toc-item::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 0;
  background: hsl(var(--primary) / 0.1);
  transition: width 0.2s ease;
  z-index: -1;
}

.toc-item:hover::before {
  width: 100%;
}

.typewriter-cursor {
  display: inline-block;
  width: 2px;
  height: 1em;
  margin-left: 1px;
  background-color: hsl(var(--primary));
  vertical-align: text-bottom;
  animation: cursor-blink 0.6s step-end infinite;
}

@keyframes cursor-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}

@media (prefers-reduced-motion: reduce) {
  .typewriter-cursor {
    animation: none;
  }
}
